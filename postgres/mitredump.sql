--
-- PostgreSQL database dump
--

-- Dumped from database version 12.5 (Ubuntu 12.5-0ubuntu0.20.04.1)
-- Dumped by pg_dump version 12.5 (Ubuntu 12.5-0ubuntu0.20.04.1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: mitre; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA mitre;


ALTER SCHEMA mitre OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: complex_cpe_to_cpe; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.complex_cpe_to_cpe (
    complex_cpes_cpe_id character varying(255) NOT NULL,
    cpe_objs_cpe_id character varying(255) NOT NULL
);


ALTER TABLE mitre.complex_cpe_to_cpe OWNER TO postgres;

--
-- Name: cpe; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cpe (
    dtype character varying(31) NOT NULL,
    cpe_id character varying(255) NOT NULL,
    edition character varying(255),
    language character varying(255),
    other character varying(255),
    product character varying(255),
    swedition character varying(255),
    targethw character varying(255),
    targetsw character varying(255),
    "Update" character varying(255),
    vendor character varying(255),
    version character varying(255),
    version_end_excluding character varying(255),
    version_end_including character varying(255),
    version_start_excluding character varying(255),
    version_start_including character varying(255),
    vulnerable boolean
);


ALTER TABLE mitre.cpe OWNER TO postgres;

--
-- Name: cpenode; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cpenode (
    id bigint NOT NULL,
    cve_obj_meta_data_id character varying(255) NOT NULL
);


ALTER TABLE mitre.cpenode OWNER TO postgres;

--
-- Name: cpenode_counts; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cpenode_counts (
    cpenodeobject_id bigint NOT NULL,
    counts integer
);


ALTER TABLE mitre.cpenode_counts OWNER TO postgres;

--
-- Name: cpenode_cpecomplex; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cpenode_cpecomplex (
    cpe_node_objs_id bigint NOT NULL,
    complex_cpe_objs_cpe_id character varying(255) NOT NULL
);


ALTER TABLE mitre.cpenode_cpecomplex OWNER TO postgres;

--
-- Name: cpenode_id_seq; Type: SEQUENCE; Schema: mitre; Owner: postgres
--

ALTER TABLE mitre.cpenode ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME mitre.cpenode_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: cpenode_operators; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cpenode_operators (
    cpenodeobject_id bigint NOT NULL,
    operators character varying(255)
);


ALTER TABLE mitre.cpenode_operators OWNER TO postgres;

--
-- Name: cve; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cve (
    meta_data_id character varying(255) NOT NULL,
    cve_data_version character varying(255),
    cvss_v2_base_score double precision NOT NULL,
    cvss_v3_base_score double precision NOT NULL,
    data_format character varying(255),
    data_type character varying(255),
    data_version character varying(255),
    last_modified_date timestamp without time zone,
    meta_data_assigner character varying(255),
    published_date timestamp without time zone,
    cvss_v2_id bigint,
    cvss_v3_id bigint
);


ALTER TABLE mitre.cve OWNER TO postgres;

--
-- Name: cve_descriptions; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cve_descriptions (
    cveobject_meta_data_id character varying(255) NOT NULL,
    descriptions character varying(8191)
);


ALTER TABLE mitre.cve_descriptions OWNER TO postgres;

--
-- Name: cvss2; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cvss2 (
    id bigint NOT NULL,
    ac_insuf_info character varying(255),
    access_complexity character varying(255),
    access_vector character varying(255),
    authentication character varying(255),
    availability_impact character varying(255),
    base_score_v2 double precision NOT NULL,
    confidentiality_impact character varying(255),
    exploitability_score_v2 double precision NOT NULL,
    impact_score_v2 double precision NOT NULL,
    integrity_impact character varying(255),
    obtain_all_privilege character varying(255),
    obtain_other_privilege character varying(255),
    obtain_user_privilege character varying(255),
    severity character varying(255),
    user_interaction_required character varying(255),
    vector_string character varying(255),
    version character varying(255)
);


ALTER TABLE mitre.cvss2 OWNER TO postgres;

--
-- Name: cvss2_id_seq; Type: SEQUENCE; Schema: mitre; Owner: postgres
--

ALTER TABLE mitre.cvss2 ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME mitre.cvss2_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: cvss3; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.cvss3 (
    id bigint NOT NULL,
    attack_complexity character varying(255),
    attack_vector character varying(255),
    availability_impact character varying(255),
    base_score_v3 double precision NOT NULL,
    base_severity_v3 character varying(255),
    confidentiality_impact character varying(255),
    exploitability_score_v3 double precision NOT NULL,
    impact_score_v3 double precision NOT NULL,
    integrity_impact character varying(255),
    privileges_required character varying(255),
    scope character varying(255),
    user_interaction character varying(255),
    vector_string character varying(255),
    version character varying(255)
);


ALTER TABLE mitre.cvss3 OWNER TO postgres;

--
-- Name: cvss3_id_seq; Type: SEQUENCE; Schema: mitre; Owner: postgres
--

ALTER TABLE mitre.cvss3 ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME mitre.cvss3_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: reference; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.reference (
    id bigint NOT NULL,
    name character varying(8191),
    refsource character varying(255),
    url character varying(8191),
    cve_obj_meta_data_id character varying(255) NOT NULL
);


ALTER TABLE mitre.reference OWNER TO postgres;

--
-- Name: reference_id_seq; Type: SEQUENCE; Schema: mitre; Owner: postgres
--

ALTER TABLE mitre.reference ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME mitre.reference_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: reference_tags; Type: TABLE; Schema: mitre; Owner: postgres
--

CREATE TABLE mitre.reference_tags (
    referenceobject_id bigint NOT NULL,
    tags character varying(255)
);


ALTER TABLE mitre.reference_tags OWNER TO postgres;

--
-- Name: cpe cpe_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpe
    ADD CONSTRAINT cpe_pkey PRIMARY KEY (cpe_id);


--
-- Name: cpenode cpenode_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode
    ADD CONSTRAINT cpenode_pkey PRIMARY KEY (id);


--
-- Name: cve cve_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cve
    ADD CONSTRAINT cve_pkey PRIMARY KEY (meta_data_id);


--
-- Name: cvss2 cvss2_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cvss2
    ADD CONSTRAINT cvss2_pkey PRIMARY KEY (id);


--
-- Name: cvss3 cvss3_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cvss3
    ADD CONSTRAINT cvss3_pkey PRIMARY KEY (id);


--
-- Name: reference reference_pkey; Type: CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.reference
    ADD CONSTRAINT reference_pkey PRIMARY KEY (id);


--
-- Name: cpe_vendor_product_idx; Type: INDEX; Schema: mitre; Owner: postgres
--

CREATE INDEX cpe_vendor_product_idx ON mitre.cpe USING btree (vendor, product);


--
-- Name: complex_cpe_to_cpe fk2ybvrb5faen4xgkklg18rmy36; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.complex_cpe_to_cpe
    ADD CONSTRAINT fk2ybvrb5faen4xgkklg18rmy36 FOREIGN KEY (cpe_objs_cpe_id) REFERENCES mitre.cpe(cpe_id);


--
-- Name: cpenode_cpecomplex fk3g00p58o951q8d2wc661p2p56; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode_cpecomplex
    ADD CONSTRAINT fk3g00p58o951q8d2wc661p2p56 FOREIGN KEY (cpe_node_objs_id) REFERENCES mitre.cpenode(id);


--
-- Name: reference_tags fk4gnflqjtex5yycu9iojtdv1d2; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.reference_tags
    ADD CONSTRAINT fk4gnflqjtex5yycu9iojtdv1d2 FOREIGN KEY (referenceobject_id) REFERENCES mitre.reference(id);


--
-- Name: cve_descriptions fk4rgpqyxyh6l8264nlu7ofx1ao; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cve_descriptions
    ADD CONSTRAINT fk4rgpqyxyh6l8264nlu7ofx1ao FOREIGN KEY (cveobject_meta_data_id) REFERENCES mitre.cve(meta_data_id);


--
-- Name: cpenode fk8sbcsg1urp8trpqyh15qkp62j; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode
    ADD CONSTRAINT fk8sbcsg1urp8trpqyh15qkp62j FOREIGN KEY (cve_obj_meta_data_id) REFERENCES mitre.cve(meta_data_id);


--
-- Name: complex_cpe_to_cpe fk94h5jgysa1m42km9yo83i85a5; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.complex_cpe_to_cpe
    ADD CONSTRAINT fk94h5jgysa1m42km9yo83i85a5 FOREIGN KEY (complex_cpes_cpe_id) REFERENCES mitre.cpe(cpe_id);


--
-- Name: cve fk99froctd1q96xb893dn64hnk4; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cve
    ADD CONSTRAINT fk99froctd1q96xb893dn64hnk4 FOREIGN KEY (cvss_v3_id) REFERENCES mitre.cvss3(id);


--
-- Name: cve fk9ie96dqf2c205na5gnba0bfjk; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cve
    ADD CONSTRAINT fk9ie96dqf2c205na5gnba0bfjk FOREIGN KEY (cvss_v2_id) REFERENCES mitre.cvss2(id);


--
-- Name: cpenode_operators fkbvbjtoj08p4b8o74nbhkgo6tu; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode_operators
    ADD CONSTRAINT fkbvbjtoj08p4b8o74nbhkgo6tu FOREIGN KEY (cpenodeobject_id) REFERENCES mitre.cpenode(id);


--
-- Name: cpenode_counts fkdlv3yc8dvx8xeenlodpnsdxje; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode_counts
    ADD CONSTRAINT fkdlv3yc8dvx8xeenlodpnsdxje FOREIGN KEY (cpenodeobject_id) REFERENCES mitre.cpenode(id);


--
-- Name: reference fkdtw6pepfy8y2moyv1lxh9qlg6; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.reference
    ADD CONSTRAINT fkdtw6pepfy8y2moyv1lxh9qlg6 FOREIGN KEY (cve_obj_meta_data_id) REFERENCES mitre.cve(meta_data_id);


--
-- Name: cpenode_cpecomplex fkskgf3ew2fceewyfafxf287iul; Type: FK CONSTRAINT; Schema: mitre; Owner: postgres
--

ALTER TABLE ONLY mitre.cpenode_cpecomplex
    ADD CONSTRAINT fkskgf3ew2fceewyfafxf287iul FOREIGN KEY (complex_cpe_objs_cpe_id) REFERENCES mitre.cpe(cpe_id);


--
-- PostgreSQL database dump complete
--

